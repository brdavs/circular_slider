function slider(a,b){function g(a,b,c){var d=Math.sqrt(Math.pow(b.x-a.x,2)+Math.pow(b.y-a.y,2)),e=Math.sqrt(Math.pow(b.x-c.x,2)+Math.pow(b.y-c.y,2)),f=Math.sqrt(Math.pow(c.x-a.x,2)+Math.pow(c.y-a.y,2)),g=Math.acos((e*e+d*d-f*f)/(2*e*d)),h=180*g/Math.PI;return a.x<c.x?h:180-h+180}function h(a,b,c,d){var e=(d-90)*Math.PI/180;return{x:a+c*Math.cos(e),y:b+c*Math.sin(e)}}function i(a,b,c,d,e){var f=h(a,b,c,e),g=h(a,b,c,d),i=e+d<=180?0:1,j=["M",f.x,f.y,"A",c,c,0,i,1,g.x,g.y].join(" ");return j}function j(a){var b=a.getBoundingClientRect();return{x:b.width/2+b.left,y:b.height/2+b.top}}function l(a){for(var b=[a.bg_gap_color,a.bg_color,a.gap_color,a.color],c=0;c<b.length;c++){var e={el:"path",attr:{fill:"none",stroke:b[c],class:c<2?"circle circle_"+c:"arc arc_"+c,"stroke-width":a.width,"stroke-dasharray":1==Math.abs(c%2)?[a.dash,a.gap]:"",d:i(d/2,d/2,a.size/2-a.width/2-2,c<2?359.9:.1,0)}};b[c]=e}var f=ce({el:"circle",attr:{class:"handle",cx:d/2,cy:d/2,r:a.width/2+2,transform:"translate(0 0)",fill:"#fff",stroke:"#000","stroke-width":1}}),g=h(a.size/2,a.size/2,a.size/2,0);f.transform.baseVal.getItem(0).setTranslate(g.y,-(g.x-a.width/2-2));var j=ce({el:"g",content:b.concat(f)});return j.slider_data={data:a},j}function o(a,b,c,d){if(0==d)return a;var e=(c-b)/d,f=360/e,g=Math.round(a/f);return f*g}function p(a,b){"touchmove"==a.type?(f.x=a.touches[0].clientX,f.y=a.touches[0].clientY):(f.x=a.clientX,f.y=a.clientY),e=b?[b]:e,e.forEach(function(b){if(b.slider_data.rotating||["mousedown","touchmove"].indexOf(a.type)!=-1){var c=b.getElementsByClassName("handle")[0];b.slider_data.m={x:f.x,y:f.y};var e=b.slider_data,j=b.slider_data.data,k=b.slider_data.angle=g(e.a,e.c,e.m),l=o(k,j.min_value,j.max_value,j.step),m=b.slider_data.handle_pos=h(j.size,j.size,j.size/2-j.width/2-2,l),n=1/360*l;b.slider_data.value=(j.max_value-j.min_value)*n+j.min_value;c.transform.baseVal.getItem(0).setTranslate(m.x-j.size,m.y-j.size);for(var q=b.getElementsByClassName("arc"),r=0;r<q.length;r++)arc_data=i(d/2,d/2,j.size/2-j.width/2-2,360==l?l-.1:l,0),q[r].setAttribute("d",arc_data);if(infobox_element){var s=infobox_element.querySelector("."+j.class+" .value");s.textContent="$ "+b.slider_data.value.toFixed(2)}}})}var c={name:"Transportation",size:100,width:10,dash:6,gap:2,rotate:0,min_value:100,max_value:200,step:0,gap_color:"#977fa1",color:"#5f3b6f",bg_gap_color:"#d7d7d7",bg_color:"#c8c8c8"};b=b.map(function(a){for(k in c)c.hasOwnProperty(k)&&!a.hasOwnProperty(k)&&(a[k]=c[k]);return a}),console.log(b),b=b.sort(function(a,b){return a.size<b.size?1:-1});var d=b[0].size,e=this.sliders=[],f={};b.forEach(function(a){a.class=a.name.toLowerCase().replace(" ","_"),e.push(l(a))});var m=ce({el:"svg",attr:{width:b[0].size,height:b[0].size,viewbox:"0 0 "+[b[0].size,b[0].size].join(" ")},content:this.sliders}),m=this.svg=m,n=document.getElementById(a);n.appendChild(m),n.style.width=b[0].size+"px",n.style.height=n.style.width,infobox_element=null,this.infobox=function(a){return infobox_element=document.getElementById(a),e.forEach(function(a){var b=a.slider_data.data,c=ce({el:"div",attr:{class:["slider",b.class].join(" ")},content:["value","box","name"].map(function(a){switch(a){case"value":content="$ "+b.min_value.toFixed(2);break;case"name":content=b.name;break;default:content=""}return{el:"div",attr:{class:a,style:"box"==a&&"background-color:"+b.color+";"},content:content}})});infobox_element.appendChild(c)}),infobox_element},this.sliders=this.sliders.map(function(a){var b=a.getElementsByClassName("handle")[0];return a.slider_data.rotating=!1,a.slider_data.halt="",a.slider_data.c=j(m),a.slider_data.a=j(b),a.slider_data.m=j(b),a.slider_data.angle=g(a.slider_data.a,a.slider_data.c,a.slider_data.m),a.slider_data.handle_pos=h(a.slider_data.data.size,a.slider_data.data.size,a.slider_data.data.size/2-a.slider_data.data.width/2-2,a.slider_data.angle),"mousedown touchstart".split(" ").forEach(function(c){b.addEventListener(c,function(b){a.slider_data.rotating=!0})}),a.addEventListener("mousedown",function(b){p(b,a)},!1),a}),document.addEventListener("mouseup",function(a){e=e.map(function(a){return a.slider_data.rotating=!1,a})},!1),"mousemove touchmove".split(" ").forEach(function(){document.addEventListener("mousemove",p)})}function ce(a){var b=document.createElement(a.el);b="div"!=a.el?document.createElementNS("http://www.w3.org/2000/svg",a.el):b;for(k in a.attr)a.attr.hasOwnProperty(k)&&b.setAttribute(k,a.attr[k]);return a.content?(a.content.constructor!==Array&&(a.content=[a.content]),a.content.forEach(function(a){"string"==typeof a?n_item=document.createTextNode(a):n_item=a.attributes?a:ce(a),b.appendChild(n_item)}),b):b}